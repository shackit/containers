# k8

Run a kubernetes setup locally with Vagrant.

## Configure DNS

### Setup the kube-system namespace

> 31/03/2017: This namespace exists without having to create.

    kubectl create namespace kube-system

### Deploy DNS

    kubectl create -f /vagrant/pods/kube-dns-rc.yaml

Confirm that the replication controller is present:

    kubectl get rc --namespace kube-system
    NAME           DESIRED   CURRENT   READY     AGE
    kube-dns-v18   1         1         1         8m


## Deploy the kubernetes dashboard

The kube-system namespace and DNS are pre-requisites.

    kubectl create -f /vagrant/pods/kubernetes-dashboard.yml

Confirm that the dashboard is running with this command:

    kubectl get svc --namespace kube-system
    NAME                   CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
    kubernetes-dashboard   172.17.227.182   <nodes>       80:30975/TCP   5m

## Basic example running nginx

    kubectl run nginx --image=nginx --replicas=2 --port=80

This didn't work locally on vagrant

    kubectl expose deployment nginx --port=80

Explicitly expose a deployment on a particular IP

    kubectl expose deployment nginx --port=80 --external-ip=192.168.1.81

## Basic example running a custom container

Create the pod

    kubectl create -f /vagrant/pods/node-demo-pod.yml

Create the service

    kubectl create -f /vagrant/pods/node-demo-svc.yml
